---
import BaseLayout from '@/layouts/BaseLayout.astro'
import Layout from '@/components/Layout.astro'
import { Container } from '@/components/Container'
import { TipButton } from '@/components/TipButton'
import { AnalyticsLink } from '@/components/AnalyticsLink'
import { BlueskyIcon, GitHubIcon, LinkedInIcon } from '@/components/SocialIcons'
import { formatDate } from '@/lib/formatDate'
import { getCollection, type CollectionEntry } from 'astro:content'

// Get recent blog posts for the homepage preview
const allPosts: CollectionEntry<'blog'>[] = await getCollection('blog')
const articles = allPosts
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())
  .slice(0, 4) // Show only the 4 most recent posts

// Resume data
const resume = [
  {
    company: 'hosting.com',
    title: 'L2 Linux Support Specialist',
    logo: '/images/logos/hosting_com.png',
    start: '2023',
    end: 'Present',
  },
  {
    company: 'InMotion Hosting',
    title: 'Technical Support Specialist',
    logo: '/images/logos/inmotion-hosting.png',
    start: '2022',
    end: '2023',
  },
  {
    company: 'Intuit',
    title: 'Data Services Expert',
    logo: '/images/logos/intuit.png',
    start: '2018',
    end: '2021',
  },
]

// Photo paths
const photos = [
  '/images/photos/image-1.jpg',
  '/images/photos/image-2.jpg',
  '/images/photos/image-3.jpeg',
  '/images/photos/image-4.jpeg',
  '/images/photos/image-5.jpeg',
]

const rotations = ['rotate-2', '-rotate-2', 'rotate-2', 'rotate-2', '-rotate-2']
---

<BaseLayout title="Michael Kinder - Mountain-dwelling Linux specialist">
  <Layout>

  <Container className="mt-9">
    <div class="max-w-2xl">
      <h1 class="text-4xl font-normal tracking-tight text-zinc-800 sm:text-5xl dark:text-zinc-100" style="font-family: 'Covered By Your Grace', cursive;">
        Hey, I'm Michael. ðŸ‘‹
      </h1>
      <p class="mt-6 text-base text-zinc-600 dark:text-zinc-400">
        I'm a mountain-dwelling Linux specialist who solves server
        puzzles by day and contributes to open source by night. When
        I'm not taming command lines at hosting.com or leading design
        for Rocky Linux, you'll find me exploring the Appalachian
        trails or coding up solutions to make mountain life a little more
        automated. Welcome to my digital cabin â€” grab some coffee and stay
        awhile.
      </p>
      <div class="mt-6 flex items-center gap-6">
        <!-- Social Links -->
        <a 
          href="https://bsky.app/profile/foggymtndrifter.com"
          aria-label="Follow on Bluesky"
          class="group -m-1 p-1"
        >
          <BlueskyIcon className="h-6 w-6 fill-zinc-500 transition group-hover:fill-zinc-600 dark:fill-zinc-400 dark:group-hover:fill-zinc-300" />
        </a>
        <a 
          href="https://github.com/FoggyMtnDrifter"
          aria-label="Follow on GitHub"
          class="group -m-1 p-1"
        >
          <GitHubIcon className="h-6 w-6 fill-zinc-500 transition group-hover:fill-zinc-600 dark:fill-zinc-400 dark:group-hover:fill-zinc-300" />
        </a>
        <a 
          href="https://linkedin.com/in/foggymtndrifter"
          aria-label="Follow on LinkedIn"
          class="group -m-1 p-1"
        >
          <LinkedInIcon className="h-6 w-6 fill-zinc-500 transition group-hover:fill-zinc-600 dark:fill-zinc-400 dark:group-hover:fill-zinc-300" />
        </a>
        <TipButton client:load />
      </div>
    </div>
  </Container>

  <!-- Photos Section -->
  <div class="mt-16 sm:mt-20">
    <div class="-my-4 flex justify-center gap-5 overflow-hidden py-4 sm:gap-8">
      {photos.map((photo, imageIndex) => (
        <div
          class={`relative aspect-9/10 w-44 flex-none overflow-hidden rounded-xl bg-zinc-100 sm:w-72 sm:rounded-2xl dark:bg-zinc-800 ${rotations[imageIndex % rotations.length]}`}
        >
          <img
            src={photo}
            alt=""
            class="absolute inset-0 h-full w-full object-cover"
          />
        </div>
      ))}
    </div>
  </div>

  <Container className="mt-24 md:mt-28">
    <div class="mx-auto grid max-w-xl grid-cols-1 gap-y-20 lg:max-w-none lg:grid-cols-2">
      <div class="flex flex-col gap-16">
        <!-- Articles -->
        {articles.map((article) => (
          <article class="group relative flex flex-col items-start">
            <h2 class="text-base font-semibold tracking-tight text-zinc-800 dark:text-zinc-100">
              <a href={`/blog/${article.id.replace('.md', '')}`}>
                <div class="absolute -inset-x-4 -inset-y-6 z-0 scale-95 bg-zinc-50 opacity-0 transition group-hover:scale-100 group-hover:opacity-100 sm:-inset-x-6 sm:rounded-2xl dark:bg-zinc-800/50"></div>
                <span class="absolute -inset-x-4 -inset-y-6 z-20 sm:-inset-x-6 sm:rounded-2xl"></span>
                <span class="relative z-10">{article.data.title}</span>
              </a>
            </h2>
            <p class="relative z-10 order-first mb-3 flex items-center text-sm text-zinc-400 dark:text-zinc-500 pl-3.5">
              <span class="absolute inset-y-0 left-0 flex items-center" aria-hidden="true">
                <span class="h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span>
              </span>
              <time datetime={article.data.pubDate.toISOString()}>{formatDate(article.data.pubDate.toISOString())}</time>
            </p>
            <p class="relative z-10 mt-2 text-sm text-zinc-600 dark:text-zinc-400">
              {article.data.description}
            </p>
            <div
              aria-hidden="true"
              class="relative z-10 mt-4 flex items-center text-sm font-medium text-violet-600 dark:text-violet-400"
            >
              Read article
              <svg viewBox="0 0 16 16" fill="none" aria-hidden="true" class="ml-1 h-4 w-4 stroke-current">
                <path
                  d="M6.75 5.75 9.25 8l-2.5 2.25"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </div>
          </article>
        ))}
      </div>
      <div class="space-y-10 lg:pl-16 xl:pl-24">
        <!-- Resume -->
        <div class="rounded-2xl border border-zinc-100 p-6 dark:border-zinc-700/40">
          <h2 class="flex text-sm font-semibold text-zinc-900 dark:text-zinc-100">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
              aria-hidden="true"
              class="h-6 w-6 flex-none"
            >
              <path
                d="M2.75 9.75a3 3 0 0 1 3-3h12.5a3 3 0 0 1 3 3v8.5a3 3 0 0 1-3 3H5.75a3 3 0 0 1-3-3v-8.5Z"
                class="fill-zinc-100 stroke-zinc-400 dark:fill-zinc-100/10 dark:stroke-zinc-500"
              />
              <path
                d="M3 14.25h6.249c.484 0 .952-.002 1.316.319l.777.682a.996.996 0 0 0 1.316 0l.777-.682c.364-.32.832-.319 1.316-.319H21M8.75 6.5V4.75a2 2 0 0 1 2-2h2.5a2 2 0 0 1 2 2V6.5"
                class="stroke-zinc-400 dark:stroke-zinc-500"
              />
            </svg>
            <span class="ml-3">Work</span>
          </h2>
          <ol class="mt-6 space-y-4">
            {resume.map((role) => (
              <li class="flex gap-4">
                <div class="relative mt-1 flex h-10 w-10 flex-none items-center justify-center rounded-full shadow-md ring-1 shadow-zinc-800/5 ring-zinc-900/5 dark:border dark:border-zinc-700/50 dark:bg-zinc-800 dark:ring-0">
                  <img src={role.logo} alt="" class="h-7 w-7" />
                </div>
                <dl class="flex flex-auto flex-wrap gap-x-2">
                  <dt class="sr-only">Company</dt>
                  <dd class="w-full flex-none text-sm font-medium text-zinc-900 dark:text-zinc-100">
                    {role.company}
                  </dd>
                  <dt class="sr-only">Role</dt>
                  <dd class="text-xs text-zinc-500 dark:text-zinc-400">
                    {role.title}
                  </dd>
                  <dt class="sr-only">Date</dt>
                  <dd
                    class="ml-auto text-xs text-zinc-400 dark:text-zinc-500"
                    aria-label={`${role.start} until ${role.end}`}
                  >
                    <time datetime={role.start}>{role.start}</time>
                    <span aria-hidden="true">â€”</span>
                    <time datetime={role.end}>{role.end}</time>
                  </dd>
                </dl>
              </li>
            ))}
          </ol>
          <AnalyticsLink
            href="/cv.pdf"
            target="_blank"
            eventName="cv_download_click"
            eventProps={{ source: "homepage" }}
            className="group mt-6 w-full inline-flex items-center justify-center rounded-md bg-zinc-50 px-3 py-2 text-sm font-medium text-zinc-900 hover:bg-zinc-100 active:bg-zinc-100 active:text-zinc-900/60 dark:bg-zinc-800/50 dark:text-zinc-300 dark:hover:bg-zinc-800 dark:hover:text-zinc-50 dark:active:bg-zinc-800/50 dark:active:text-zinc-50/70"
            client:load
          >
            Download CV
            <svg viewBox="0 0 16 16" fill="none" aria-hidden="true" class="h-4 w-4 stroke-zinc-400 transition group-active:stroke-zinc-600 dark:group-hover:stroke-zinc-50 dark:group-active:stroke-zinc-50 ml-1">
              <path
                d="M4.75 8.75 8 12.25m0 0 3.25-3.5M8 12.25v-8.5"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </AnalyticsLink>
        </div>
      </div>
    </div>
  </Container>
  </Layout>
</BaseLayout>
